###
### Quickness Settings
###

# This should allow for quick sourcing of formulas
export Q=$QUICKNESS/formulas

export QUICKNESS_BIN=$QUICKNESS/bin
export QUICKNESS_ETC=$QUICKNESS/etc
export QUICKNESS_TWEAKS=$QUICKNESS/tweaks

export QUICKNESS_HOME=$HOME/.quickness
export QUICKNESS_SRC=$HOME/.quickness/src


### Get major and minor number for OS
export OS_VER=$(lsb_release -r | cut -d ":" -f 2 | sed 's/^[\t ]*//g')
export OS_MAJOR=$(echo $OS_VER | cut -d "." -f 1)
export OS_MINOR=$(echo $OS_VER | cut -d "." -f 2)


### Set the OS name
if [ $OS_MAJOR -eq 10 ] && [ $OS_MINOR -eq 04 ]; then
    export OS_NAME="lucid"
elif [ $OS_MAJOR -eq 10 ] && [ $OS_MINOR -eq 10 ]; then
    export OS_NAME="maverick"
elif [ $OS_MAJOR -eq 11 ] && [ $OS_MINOR -eq 04 ]; then
    export OS_NAME="natty"
elif [ $OS_MAJOR -eq 11 ] && [ $OS_MINOR -eq 10 ]; then
    export OS_NAME="oneiric"
elif [ $OS_MAJOR -eq 12 ] && [ $OS_MINOR -eq 04 ]; then
    export OS_NAME="precise"  # default
fi

###
### Quickness Workspaces
###

if [ ! -d $QUICKNESS_HOME ]; then
    mkdir $QUICKNESS_HOME
fi
if [ ! -d $QUICKNESS_SRC ]; then
    mkdir $QUICKNESS_SRC
fi

# experimental functions to gather up all the echo statements from the formulas, so we can display them all at once at the end of the run
export QUICKNESS_MSG=/tmp/quickness.msg

quickness_init() {
    if [ -z "$1" ]; then
        echo "Pass <formula> argument to quickness_init"
    else
        if [ -z "$QUICKNESS_FORMULA_NAME" ]; then
            export QUICKNESS_FORMULA_NAME="$1"
            if [ -f $QUICKNESS_MSG ]; then
                rm $QUICKNESS_MSG
            fi
            touch $QUICKNESS_MSG
        fi
    fi
}

quickness_msg() {
    echo "$@" >> $QUICKNESS_MSG
}

quickness_teardown() {
    if [ -z "$1" ]; then
        echo "Pass <formula> argument to quickness_teardown"
    else
        if [ "$1" = "$QUICKNESS_FORMULA_NAME" ]; then
            cat $QUICKNESS_MSG
            rm $QUICKNESS_MSG
        fi
    fi
}

### Path
export PATH=$QUICKNESS_BIN:$PATH
