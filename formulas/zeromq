###
### ZeroMQ
###
### As of the release of precise pangolin zeromq is
### a version behind, if you want to just install the
### the version in the standard repo pass the ubuntu
### argument to the formula '. $Q/zeromq ubuntu'
###

###
### Initialize
###

if [ "$(is_formula_installed)" = "yes" ]; then
    quickness_teardown
    return
fi

ZEROMQ_VERSION="zeromq-2.2.0"
ZEROMQ_PREV_DIR=$PWD
cd $QUICKNESS_SRC


###
### Installation
###

if [ "$1" = "ubuntu" ]; then
    sudo apt-get -y install libzmq-dev
else
    if [ -d $ZEROMQ_VERSION ]; then
        rm -rf $ZEROMQ_VERSION
    fi
    if [ ! -f $ZEROMQ_VERSION.tar.gz ]; then
        wget http://download.zeromq.org/$ZEROMQ_VERSION.tar.gz
    fi

    sudo apt-get -y install \
        libtool \
        uuid-dev

    tar zxf $ZEROMQ_VERSION.tar.gz
    cd $ZEROMQ_VERSION
    ./configure && make && sudo make install
    sudo ldconfig
fi


###
### Teardown
###

cd $ZEROMQ_PREV_DIR
unset ZEROMQ_VERSION
unset ZEROMQ_PREV_DIR

quickness_teardown
