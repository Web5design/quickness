###
### Python Development Libraries
###
### This formula takes an optional name argument that will create a virtualenv
###

###
### Initialize
###

if [ "$(is_formula_installed)" = "yes" ]; then
    quickness_teardown
    return
fi

PYTHON_DEV_PREV_DIR=$PWD
cd $QUICKNESS_SRC


###
### Dependencies
###

### optional dependency for Fabric
sudo apt-get -y install \
    libgmp3-dev


###
### Installation
###

sudo apt-get -y install \
    python-dev

### Install at system level
if [ -z "$VIRTUAL_ENV" ]; then
    sudo easy_install virtualenv virtualenvwrapper
fi

### Update Profile
if [ -z "$(grep VirtualEnv $HOME/.profile)" ]; then
    echo "" >> $HOME/.profile
    echo "### VirtualEnv" >> $HOME/.profile
    echo ". /usr/local/bin/virtualenvwrapper.sh" >> $HOME/.profile
fi

### Source this so they don't need to logout/login
. /usr/local/bin/virtualenvwrapper.sh

### Only create the virtualenv when not already in one
if [ -z "$VIRTUAL_ENV" ] && [ ! -z "$1" ]; then
    quickness_msg "a virtualenv has been created named $1"
    mkvirtualenv $1
fi


###
### Teardown
###

cd $PYTHON_DEV_PREV_DIR
unset PYTHON_DEV_PREV_DIR

quickness_teardown
