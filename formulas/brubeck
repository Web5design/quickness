###
### Brubeck
###
### Install consists of installing ZeroMQ and Mongrel2 as well as all
### Python dependencies.  To create an actual brubeck application you
### should create a <project_name>_private file in the formula directory
### and source this formula in (look at the listsurf formula for ideas).
###

###
### Initialize
###

is_formula_installed && return || formula_init

cd $QUICKNESS_SRC

APP_NAME="brubeck"
if [ ! -z "$1" ]; then
    APP_NAME="$1"
fi


###
### Dependencies
###

. $Q/evented_libs
. $Q/mongrel2
. $Q/python_dev $APP_NAME


###
### Installation
###

if [ -d "brubeck" ]; then
    cd brubeck
    git checkout master
    git pull
else
    git clone $BRUBECK_URL
    cd brubeck
fi

### Install Brubeck's dependencies
pip install -r envs/brubeck.reqs
pip install -r envs/gevent.reqs

### Install Brubeck itself
python setup.py install


###
### Teardown
###

unset APP_NAME

formula_msg "This formula uses gevent"

formula_teardown
