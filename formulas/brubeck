###
### Brubeck
###
### Install consists of installing ZeroMQ and Mongrel2 as well as all
### Python dependencies.  To create an actual brubeck application you
### should create a <project_name>.private file in the formula directory
### and source this formula in (look at the listsurf formula for ideas).
###

###
### init
###

if [ "$(is_formula_installed)" = "yes" ]; then
    quickness_teardown
    return
fi


###
### Settings
###

BRUBECK_PREV_DIR=$PWD
cd $QUICKNESS_SRC


###
### Formula Dependencies
###

. $Q/evented_libs
. $Q/zeromq
. $Q/mongrel2
. $Q/python_dev brubeck


###
### Installation and Configuration
###

if [ -d "brubeck" ]; then
    cd brubeck
    git checkout master
    git pull
else
    git clone https://github.com/j2labs/brubeck.git
    cd brubeck
fi

### Install Brubeck's dependencies
pip install -I -r envs/brubeck.reqs
pip install -I -r envs/gevent.reqs

### Install Brubeck itself
python setup.py install


###
### Cleanup
###

cd $BRUBECK_PREV_DIR


###
### Messages
###

quickness_msg "This formula uses gevent"


###
### Teardown
###

quickness_teardown
